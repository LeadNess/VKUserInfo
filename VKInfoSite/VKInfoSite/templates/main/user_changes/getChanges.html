{% extends "wrapper.html" %}

{% block content %}
    <h2>User account changes</h2>
    {% if main_info %}
        <span class="d-block p-2 bg-primary text-white">Main info changes</span>
        <table class="table table-striped table-dark">
            <thead>
           	     <tr>
           		    <th scope="col">Field</th>
           		    <th scope="col">Old</th>
           		    <th scope="col">New</th>
                 </tr>
            </thead>
            <tbody>
                {% for name, field in main_info.items %}
                   <tr>
                        <td>{{ name }}</td>
                        <td>{{ field.old }}</td>
                        <td>{{ field.new }}</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    {% endif %}


    {% if friends.new %}
        <span class="d-block p-2 bg-primary text-white">New friends</span>
        <table class="table table-striped table-dark">
            <thead>
           	     <tr>
                    <th scope="col">#</th>
           		    <th scope="col">Fullname</th>
           		    <th scope="col">id</th>
           		    <th scope="col">domain</th>
           		    <th scope="col">bday</th>
                 </tr>
            </thead>
            <tbody>
                {% for friend in friends.new %}
                   <tr>
                        <th scope="row">{{ forloop.counter }}</th>
                        <td><a style="color: white" href="https://vk.com/{{ friend.domain }}">{{ friend.first_name}} {{ friend.last_name }}</a></td>
                        <td>{{ friend.id }}</td>
                        <td>{{ friend.domain }}</td>
                        <td>{{ friend.bdate }}</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    {% endif %}

    {% if friends.deleted %}
        <span class="d-block p-2 bg-primary text-white">Deleted friends</span>
        <table class="table table-striped table-dark">
            <thead>
           	     <tr>
                    <th scope="col">#</th>
           		    <th scope="col">Fullname</th>
           		    <th scope="col">id</th>
           		    <th scope="col">domain</th>
           		    <th scope="col">bday</th>
                 </tr>
            </thead>
            <tbody>
                {% for friend in friends.deleted %}
                   <tr>
                        <th scope="row">{{ forloop.counter }}</th>
                        <td><a style="color: white" href="https://vk.com/{{ friend.domain }}">{{ friend.first_name}} {{ friend.last_name }}</a></td>
                        <td>{{ friend.id }}</td>
                        <td>{{ friend.domain }}</td>
                        <td>{{ friend.bdate }}</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    {% endif %}


    {% if followers.new %}
        <span class="d-block p-2 bg-primary text-white">New followers</span>
        <table class="table table-striped table-dark">
            <thead>
           	     <tr>
                    <th scope="col">#</th>
           		    <th scope="col">Fullname</th>
           		    <th scope="col">id</th>
           		    <th scope="col">domain</th>
           		    <th scope="col">bday</th>
                 </tr>
            </thead>
            <tbody>
                {% for friend in followers.new %}
                   <tr>
                        <th scope="row">{{ forloop.counter }}</th>
                        <td><a style="color: white" href="https://vk.com/{{ friend.domain }}">{{ friend.first_name}} {{ friend.last_name }}</a></td>
                        <td>{{ friend.id }}</td>
                        <td>{{ friend.domain }}</td>
                        <td>{{ friend.bdate }}</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    {% endif %}

    {% if followers.deleted %}
        <span class="d-block p-2 bg-primary text-white">Deleted followers</span>
        <table class="table table-striped table-dark">
            <thead>
           	     <tr>
                    <th scope="col">#</th>
           		    <th scope="col">Fullname</th>
           		    <th scope="col">id</th>
           		    <th scope="col">domain</th>
           		    <th scope="col">bday</th>
                 </tr>
            </thead>
            <tbody>
                {% for friend in followers.deleted %}
                   <tr>
                        <th scope="row">{{ forloop.counter }}</th>
                        <td><a style="color: white" href="https://vk.com/{{ friend.domain }}">{{ friend.first_name}} {{ friend.last_name }}</a></td>
                        <td>{{ friend.id }}</td>
                        <td>{{ friend.domain }}</td>
                        <td>{{ friend.bdate }}</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    {% endif %}


    {% if groups.new %}
        <span class="d-block p-2 bg-primary text-white">New groups</span>
        <table class="table table-striped table-dark">
            <thead>
           	     <tr>
                    <th scope="col">#</th>
           		    <th scope="col">Name</th>
           		    <th scope="col">id</th>
           		    <th scope="col">Screen name</th>
                 </tr>
            </thead>
            <tbody>
                {% for group in groups.new %}
                <tr>
                    <th scope="row">{{ forloop.counter }}</th>
                    <td><a style="color: white" href="https://vk.com/{{ group.screen_name }}">{{ group.name }}</a></td>
                    <td>{{ group.id }}</td>
                    <td>{{ group.screen_name }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    {% endif %}

    {% if groups.deleted %}
        <span class="d-block p-2 bg-primary text-white">Deleted groups</span>
        <table class="table table-striped table-dark">
            <thead>
           	     <tr>
                    <th scope="col">#</th>
           		    <th scope="col">Name</th>
           		    <th scope="col">id</th>
           		    <th scope="col">Screen name</th>
                 </tr>
            </thead>
            <tbody>
                {% for group in groups.deleted %}
                <tr>
                    <th scope="row">{{ forloop.counter }}</th>
                    <td><a style="color: white" href="https://vk.com/{{ group.screen_name }}">{{ group.name }}</a></td>
                    <td>{{ group.id }}</td>
                    <td>{{ group.screen_name }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    {% endif %}


    {% if info.photos.new %}
        <span class="d-block p-2 bg-primary text-white">New photos</span>
        <table class="table table-striped table-dark">
            <thead>
       	         <tr>
                    <th scope="col">#</th>
           		    <th scope="col">Photo id</th>
           		    <th scope="col">Likes</th>
           		    <th scope="col">Comments</th>
                 </tr>
            </thead>
            <tbody>
                {% for photo in info.photos.new %}
                    <tr>
                        <th scope="row">{{ forloop.counter }}</th>
                        <td><a style="color: white" href="https://vk.com/{{ domain }}?z=photo{{ id }}_{{ photo.photo_id }}%2Fphotos{{ id }}">{{ photo.photo_id }}</a></td>
                        <td><p>Count: {{ photo.likes.count }}</p>
                            {% for like in photo.likes.items %}
                                 <p><a style="color: white" href="https://vk.com/id{{ like.id }}">{{ like.first_name }} {{ like.last_name }}</a></p>
                            {% endfor %}
                        </td>
                        <td>
                            {% for comment in photo.comments.items %}
                                <p><a style="color: white" href="https://vk.com/id{{ comment.from_id }}">From</a></p>
                                {% if 'attachments' in comment and not comment.text %}
                                     <p>Attachment: {{ comment.attachments.0.type }}</p>
                                {% else %}
                                     <p>Text: {{ comment.text }}</p>
                                {% endif %}
                                <br>
                            {% endfor %}
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    {% endif %}


    {% if info.photos.deleted %}
        <span class="d-block p-2 bg-primary text-white">Deleted photos</span>
        <table class="table table-striped table-dark">
            <thead>
                <tr>
                    <th scope="col">#</th>
           		    <th scope="col">Photo id</th>
           		    <th scope="col">Likes</th>
           		    <th scope="col">Comments</th>
                </tr>
            </thead>
            <tbody>
                {% for photo in info.photos.deleted %}
                    <tr>
                        <th scope="row">{{ forloop.counter }}</th>
                        <td><a style="color: white" href="https://vk.com/{{ domain }}?z=photo{{ id }}_{{ photo.photo_id }}%2Fphotos{{ id }}">{{ photo.photo_id }}</a></td>
                        <td><p>Count: {{ photo.likes.count }}</p>
                            {% for like in photo.likes.items %}
                                 <p><a style="color: white" href="https://vk.com/id{{ like.id }}">{{ like.first_name }} {{ like.last_name }}</a></p>
                            {% endfor %}
                        </td>
                        <td>
                            {% for comment in photo.comments.items %}
                                <p><a style="color: white" href="https://vk.com/id{{ comment.from_id }}">From</a></p>
                                {% if 'attachments' in comment and not comment.text %}
                                     <p>Attachment: {{ comment.attachments.0.type }}</p>
                                {% else %}
                                     <p>Text: {{ comment.text }}</p>
                                {% endif %}
                                <br>
                            {% endfor %}
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    {% endif %}

    {% if info.photos.items %}
        <span class="d-block p-2 bg-primary text-white">Photos changes</span>
        <table class="table table-striped table-dark">
            <thead>
                <tr>
                    <th scope="col">#</th>
           		    <th scope="col">Photo id</th>
           		    <th scope="col">Likes</th>
           		    <th scope="col">Comments</th>
                </tr>
            </thead>
            <tbody>
                {% for photo in info.photos.items %}
                    <tr>
                        <th scope="row">{{ forloop.counter }}</th>
                        <td><a style="color: white" href="https://vk.com/{{ domain }}?z=photo{{ id }}_{{ photo.photo_id }}%2Fphotos{{ id }}">{{ photo.photo_id }}</a></td>
                        <td>
                            {% for like in photo.likes %}
                                {% if like.status %}
                                    <p><a style="color: white" href="https://vk.com/id{{ like.id }}">{{ like.first_name }} {{ like.last_name }}</a>[NEW]</p>
                                {% else %}
                                    <p><a style="color: white" href="https://vk.com/id{{ like.id }}">{{ like.first_name }} {{ like.last_name }}</a>[DELETED]</p>
                                {% endif %}
                            {% endfor %}
                        </td>
                        <td>
                            {% for comment in photo.comments %}
                                {% if comment.status %}
                                    <p>[NEW]</p>
                                    <p><a style="color: white" href="https://vk.com/id{{ comment.from_id }}">From</a></p>
                                    {% if 'attachments' in comment and not comment.text %}
                                         <p>Attachment: {{ comment.attachments.0.type }}</p>
                                    {% else %}
                                         <p>Text: {{ comment.text }}</p>
                                    {% endif %}
                                {% else %}
                                    <p>[DELETED]</p>
                                    <p><a style="color: white" href="https://vk.com/id{{ comment.from_id }}">From</a></p>
                                    {% if 'attachments' in comment and not comment.text %}
                                         <p>Attachment: {{ comment.attachments.0.type }}</p>
                                    {% else %}
                                         <p>Text: {{ comment.text }}</p>
                                    {% endif %}
                                {% endif %}
                                <br>
                            {% endfor %}
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    {% endif %}


    {% if info.wall.new %}
        <span class="d-block p-2 bg-primary text-white">New posts</span>
        <table class="table table-striped table-dark">
            <thead>
                <tr>
                <th scope="col">#</th>
          	        <th scope="col">Post id</th>
                    <th scope="col">Text</th>
                    <th scope="col">Likes</th>
           	        <th scope="col">Comments</th>
                </tr>
            </thead>
            <tbody>
                {% for post in info.wall.new %}
                    <tr>
                        <th scope="row">{{ forloop.counter }}</th>
                        <td><a style="color: white" href="https://vk.com/{{ domain }}?w=wall{{ id }}_{{ post.post_id }}%2Fall">{{ post.post_id }}</a></td>
                        <td>{{ post.text }}</td>
                        <td><p>Count: {{ post.likes.count }}</p>
                            {% for like in post.likes %}
                                 <p><a style="color: white" href="https://vk.com/id{{ like.id }}">{{ like.first_name }} {{ like.last_name }}</a></p>
                            {% endfor %}
                        </td>
                        <td>
                            {% for comment in post.comments %}
                                <p><a style="color: white" href="https://vk.com/id{{ comment.from_id }}">From</a></p>
                                {% if 'attachments' in comment and not comment.text %}
                                     <p>Attachment: {{ comment.attachments.0.type }}</p>
                                {% else %}
                                    <p>Text: {{ comment.text }}</p>
                                {% endif %}
                                <br>
                            {% endfor %}
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    {% endif %}

    {% if info.wall.deleted %}
        <span class="d-block p-2 bg-primary text-white">Deleted posts</span>
        <table class="table table-striped table-dark">
            <thead>
                <tr>
                <th scope="col">#</th>
          	        <th scope="col">Post id</th>
                    <th scope="col">Text</th>
                    <th scope="col">Likes</th>
           	        <th scope="col">Comments</th>
                </tr>
            </thead>
            <tbody>
                {% for post in info.wall.deleted %}
                    <tr>
                        <th scope="row">{{ forloop.counter }}</th>
                        <td><a style="color: white" href="https://vk.com/{{ domain }}?w=wall{{ id }}_{{ post.post_id }}%2Fall">{{ post.post_id }}</a></td>
                        <td>{{ post.text }}</td>
                        <td><p>Count: {{ post.likes.count }}</p>
                            {% for like in post.likes %}
                                 <p><a style="color: white" href="https://vk.com/id{{ like.id }}">{{ like.first_name }} {{ like.last_name }}</a></p>
                            {% endfor %}
                        </td>
                        <td>
                            {% for comment in post.comments %}
                                <p><a style="color: white" href="https://vk.com/id{{ comment.from_id }}">From</a></p>
                                {% if 'attachments' in comment and not comment.text %}
                                     <p>Attachment: {{ comment.attachments.0.type }}</p>
                                {% else %}
                                    <p>Text: {{ comment.text }}</p>
                                {% endif %}
                                <br>
                            {% endfor %}
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    {% endif %}

    {% if info.wall.items %}
        <span class="d-block p-2 bg-primary text-white">Posts changes</span>
        <table class="table table-striped table-dark">
            <thead>
                <tr>
                <th scope="col">#</th>
          	        <th scope="col">Post id</th>
                    <th scope="col">Text</th>
                    <th scope="col">Likes</th>
           	        <th scope="col">Comments</th>
                </tr>
            </thead>
            <tbody>
                {% for post in info.wall.items %}
                    <tr>
                        <th scope="row">{{ forloop.counter }}</th>
                        <td><a style="color: white" href="https://vk.com/{{ domain }}?w=wall{{ id }}_{{ post.post_id }}%2Fall">{{ post.post_id }}</a></td>
                        <td>{{ post.text }}</td>
                        <td>
                            {% for like in post.likes %}
                                {% if like.status %}
                                    <p><a style="color: white" href="https://vk.com/id{{ like.id }}">{{ like.first_name }} {{ like.last_name }}</a>[NEW]</p>
                                {% else %}
                                    <p><a style="color: white" href="https://vk.com/id{{ like.id }}">{{ like.first_name }} {{ like.last_name }}</a>[DELETED]</p>
                                {% endif %}
                            {% endfor %}
                        </td>
                        <td>
                            {% for comment in post.comments %}
                                {% if comment.status %}
                                    <p>[NEW]</p>
                                    <p><a style="color: white" href="https://vk.com/id{{ comment.from_id }}">From</a></p>
                                    {% if 'attachments' in comment and not comment.text %}
                                         <p>Attachment: {{ comment.attachments.0.type }}</p>
                                    {% else %}
                                         <p>Text: {{ comment.text }}</p>
                                    {% endif %}
                                {% else %}
                                    <p>[DELETED]</p>
                                    <p><a style="color: white" href="https://vk.com/id{{ comment.from_id }}">From</a></p>
                                    {% if 'attachments' in comment and not comment.text %}
                                         <p>Attachment: {{ comment.attachments.0.type }}</p>
                                    {% else %}
                                         <p>Text: {{ comment.text }}</p>
                                    {% endif %}
                                {% endif %}
                                <br>
                            {% endfor %}
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    {% endif %}


{% endblock %}